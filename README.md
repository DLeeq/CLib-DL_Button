# DL_Button
**Простая библиотека обработки событий и устранения дребезга кнопок для микроконтроллеров STM32 на языках C и HAL.**
## Оглавление
1. [Описание](#описание)
2. [Установка](#установка)
3. [Использование](#использование)
4. [Совместимость](#совместимость)
5. [Версии](#версии)
6. [Обратная связь](#обратная-связь)
## Описание  
Библиотека предлагает простой и понятный интерфейс для инициализации программной обработки кнопок с подавлением дребезга.
- Количество подключаемых кнопок ограничена числом свободных пинов МК
- Инициализация кнопки в две строки
- Программный антидребезг (не требуется аппаратное подавление)
- Работа с кнопками подтягивающими как к питанию так и к земле
- События:
  * Нажатие (Однократное срабатывание)
  * Нажата (Постоянное срабатывание)
  * Отпускание (Однократное срабатывание)
  * Отпущена (Постоянное срабатывание)
  * Переключение (Однократное срабатывание при нажатии и при отпускании)
  * Двойное нажатие
  * Удержание (Однократное срабатывание при удержании 500мс)

Библиотека снабжена подробными комментариями.

## Установка
**Установка в директорию с пользовательскими библиотеками (Рекомендуется):**
 1. Скачайте и добавьте директорию **DL_Button** в папку с пользовательскими библиотеками вашего проекта (создайте папку, если её нет)
 2. Укажите пути в вашей IDE для директории с заголовочным файлом и файлом реализации
 3. Подключите библиотеку с помощью директивы include:
   ```c
   #include "DL_Button.h"  //Если указаны пути в IDE путь можно не прописывать
   ```
 4. Не забудьте заменить в файле **DL_Button.h** подключаемую HAL библиотеку на вашу версию МК
   ```c
   #include "stm32f1xx_hal.h"  //Замените на свою версию
   ```
**Установка в корень проекта (Проще):**
  1. Добавьте заголовочный файл **DL_Button/DL_Button.h** в директорию с вашими заголовочными файлами проекта
  2. Добавьте файл реализации **DL_Button/DL_Button.c** в директорию с вашими заголовочными файлами проекта
  3. Подключите библиотеку с помощью директивы include:
   ```c
   #include "DL_Button.h"  //Если библиотека установлена в корень вашего проекта
   ```
  4. Не забудьте заменить в файле **DL_Button.h** подключаемую HAL библиотеку на вашу версию МК
   ```c
   #include "stm32f1xx_hal.h"  //Замените на свою версию
   ```
***Важно:***
***Внимательно проверяйте пути к заголовочному файлу и файлу реализации***
## Использование
Правильно проинициализируйте пин на вход с подяжкой, с которым работает ваша кнопка.  
Подтяжки зависят от того, к какому потенциалу подтягивает кнопка. 

Создание экземпляра структуры кнопки и инициализация:
```c
DL_Button myBtn;
DL_btnInit(&myBtn, GPIOA, GPIO_PIN_0, DL_BTN_HIGH, myBtnHandler); //Параметры: Структура кнопки, Порт, Пин, К какому уровню подтягивает, Обработчик событий
```
В основной цикл программы добавьте функцию-тикер, передав туда вашу структуру:
```c
while (1)
{
  DL_btnTick(&myBtn);  //Функция-тикер, обязательная для работы
 	...
}
```

Создание обработчика со всеми возможными событиями (вы можете оставить только те, которые вам нужны):
```c
void myBtnHandler(DL_BtnEvent event)
{
	switch(event)
	{
		case DL_BTN_PRESS:
			//Код, который будет вызываться однократно при нажатии кнопки
			break;
		case DL_BTN_RELEASE:
			//Код, который будет вызываться однократно при отпускании кнопки
			break;
		case DL_BTN_PRESSING:
			//Код, который будет вызываться постоянно при нажатии кнопки
			break;
		case DL_BTN_RELEASING:
			//Код, который будет вызываться постоянно при отпущенной кнопке
			break;
		case DL_BTN_TOGGLE:
			//Код, который будет вызываться однократно при нажатии или отпускании кнопки
			break;
		case DL_BTN_DOUBLECLICK:
			//Код, который будет вызываться однократно при двойном нажатии
			break;
		case DL_BTN_HOLD:
			//Код, который будет вызываться однократно при удержании >500мс
			break;
	}
}
```

## Совместимость
Библиотека написана, протестирована и гарантированно работает на отладочной плате "Blue Pill Plus" на базе МК STM32F103C8T6.
Благодаря использованию HAL, библиотека должна работать на подавляющем большинстве МК STM32.
## Версии
- v1.0

## Обратная связь
Если вы нашли баг, или есть предложения по доработке, пишите мне в [Телеграм - группу](https://t.me/DLeeFB) для обратной связи =)
